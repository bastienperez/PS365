---
description: Retrieves mailbox protocol settings for Exchange Online mailboxes.
id: Get-ExMailboxProtocol
title: Get-ExMailboxProtocol
hide_title: false
hide_table_of_contents: false
---

## SYNOPSIS

Retrieves mailbox protocol settings for Exchange Online mailboxes.

## SYNTAX

```powershell
Get-ExMailboxProtocol [[-Identity] <String>] [-ByDomain <String>] [-ExportToExcel]
 [-ProgressAction <ActionPreference>] [<CommonParameters>]
```

## DESCRIPTION

This function retrieves the protocol settings (MAPI, OWA, IMAP, POP, EWS, ActiveSync)
for Exchange Online mailboxes.
It can filter mailboxes by identity or by domain.
Additionally, it provides information about SMTP Client Authentication settings
at both the mailbox and tenant levels.

## EXAMPLES

### EXAMPLE 1

```powershell
Get-ExMailboxProtocol
```

Retrieves mailbox protocol settings for all Exchange Online mailboxes.

### EXAMPLE 2

```powershell
Get-ExMailboxProtocol -Identity "user@example.com"
```

Retrieves mailbox protocol settings for the specified mailbox.

### EXAMPLE 3

```powershell
Get-ExMailboxProtocol -ByDomain "example.com"
```

Retrieves mailbox protocol settings for all mailboxes in the specified domain.

### EXAMPLE 4

```powershell
Get-ExMailboxProtocol -ExportToExcel
```

Exports mailbox protocol settings for all Exchange Online mailboxes to an Excel file in the user's profile directory.

## PARAMETERS

### -Identity

The identity of the mailbox to retrieve protocol settings for.
If not specified, the function retrieves settings for all mailboxes.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ByDomain

The domain to filter mailboxes by.
Only mailboxes with a primary SMTP address in this
domain will be processed.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ExportToExcel

If specified, exports the results to an Excel file in the user's profile directory.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -ProgressAction

\{\{ Fill ProgressAction Description \}\}

```yaml
Type: ActionPreference
Parameter Sets: (All)
Aliases: proga

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters

This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

## RELATED LINKS
