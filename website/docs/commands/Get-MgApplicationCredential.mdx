---
Module Name: PS365
---

## SYNOPSIS

Retrieves all Microsoft Entra ID applications and their credentials (key and password).

## SYNTAX

```powershell
Get-MgApplicationCredential [-ExportToExcel] [-ForceNewToken] [-RunFromAzureAutomation]
 [[-ExpirationThresholdDays] <Int32>] [[-NotificationRecipient] <String>] [[-NotificationSender] <String>]
 [-ProgressAction <ActionPreference>] [<CommonParameters>]
```

## DESCRIPTION

This function returns a list of all Microsoft Entra ID applications with their credentials information,
including key credentials and password credentials, along with their validity status.
The function also retrieves the owners of each application.

## EXAMPLES

### EXAMPLE 1

```powershell
Get-MgApplicationCredential
Retrieves all Microsoft Entra ID applications and their credentials.
```

### EXAMPLE 2

```powershell
Get-MgApplicationCredential -ForceNewToken
```

Forces the function to disconnect and reconnect to Microsoft Graph to obtain a new access token.

### EXAMPLE 3

```powershell
Get-MgApplicationCredential -ExportToExcel
```

Gets all application credentials and exports them to an Excel file.

### EXAMPLE 4

```powershell
Gets all application credentials using managed identity, exports them to an Excel file, and sends notification for credentials expiring within 15 days.
```

### EXAMPLE 5

```powershell
Get-MgApplicationCredential -RunFromAzureAutomation -ExpirationThresholdDays 30 -NotificationRecipient 'admin@company.com' -NotificationSender 'automation@company.com'
```

Gets all application credentials using managed identity authentication and sends notification for credentials expiring within 30 days.

### EXAMPLE 6

```powershell
Get-MgApplicationCredential -RunFromAzureAutomation -ExpirationThresholdDays 7 -NotificationRecipient 'admin@company.com' -NotificationSender 'automation@company.com'
```

Gets all application credentials using managed identity and sends email notification for credentials expiring within 7 days.

## PARAMETERS

### -ExportToExcel

(Optional) If specified, exports the results to an Excel file in the user's profile directory.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -ForceNewToken

(Optional) Forces the function to disconnect and reconnect to Microsoft Graph to obtain a new access token.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -RunFromAzureAutomation

(Optional) If specified, uses managed identity authentication instead of interactive authentication.
This is useful when running the script in Azure environments like Azure Functions, Logic Apps, or VMs with managed identity enabled.
When this parameter is used, ExpirationThresholdDays, NotificationRecipient and NotificationSender are required.

PowerShell modules used in Azure Automation must be a MAXIMUM of version 2.25.0 when using PowerShell &lt; 7.4.0, because starting from version 2.26.0, PowerShell 7.4.0 is required, and Azure Automation does not support it yet as of February 2026.
For PowerShell 7.4.0+, there are no version restrictions.
https://github.com/microsoftgraph/msgraph-sdk-powershell/issues/3147
https://github.com/microsoftgraph/msgraph-sdk-powershell/issues/3151
https://github.com/microsoftgraph/msgraph-sdk-powershell/issues/3166

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -ExpirationThresholdDays

(Required when RunFromAzureAutomation is enabled) Number of days threshold for expiration notification.
Default is 30 days.

```yaml
Type: Int32
Parameter Sets: (All)
Aliases:

Required: False
Position: 1
Default value: 30
Accept pipeline input: False
Accept wildcard characters: False
```

### -NotificationRecipient

(Required when RunFromAzureAutomation is enabled) Email address to receive expiration notifications.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: 2
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -NotificationSender

(Required when RunFromAzureAutomation is enabled) Email address of the sender for expiration notifications.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: 3
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```
### CommonParameters

This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES

## RELATED LINKS

[https://ps365.clidsys.com/docs/commands/Get-MgApplicationCredential](https://ps365.clidsys.com/docs/commands/Get-MgApplicationCredential)
